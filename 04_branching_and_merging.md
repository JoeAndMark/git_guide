#  4 分支与合并

[TOC]

Git 的分支功能是其强大和灵活的核心之一。分支运行您在同一个项目中并行地开发不同的功能、修复错误或尝试新的想法，而不会干扰主线代码。

## 4.1 创建与切换分支

### 4.1.1 创建分支

要创建一个新的分支，您可以使用 `git branch` 命令。假设您在主分支（`main`）上工作，并且想创建一个新的分支来开发新功能

```bash
git branch <分支名>
```

### 4.1.2 切换分支

要切换到您刚创建的分支，需要使用 `git checkout` 命令：

```bash
git checkout <分支名>
```

### 4.1.3 创建并切换分支

Git 提供了一个快捷命令，`git checkout -b`，它可以同时创建并切换到新的分支：

```bash
git checkout -b <分支名>
```

## 4.2 查看分支

要查看当前仓库中存在的所有分支，可以使用 `git branch` 命令：

```bash
git branch
```

输出会列出所有本地分支，并在当前所在分支前加上一个 `*` 号。

## 4.3 合并分支

当你在一个分支上完成了开发工作，并且想把这些更改合并会主分支时，您可以使用 `git merge` 命令。

### 4.3.1 合并分支

首先，切换回你要合并到的目标分支（例如：`main`）

```bash
git checkout main
```

然后使用 `git merge` 命令合并另一个分支的更改。例如，合并 `develop` 分支到 `main` 分支：

```bash
git merge develop
```

Git 会尝试自动合并更改。如果没有冲突，合并过程会自动完成，并生成一个合并提交（*merge commit*）

### 4.3.2 解决合并冲突

有时候，Git 无法自动合并更改，这时候会产生合并冲突。冲突需要手动解决。Git 会标记出冲突的文件，并在文件中插入冲突标记，类似这样：

```bash
<<<<<<< HEAD
当前主分支的代码
=======
feature-xyz 分支的代码
>>>>>>> feature-xyz
```

您需要手动编辑这些文件，选择保留哪部分代码，或者自行修改该使之正确。解决冲突后，使用一下命令添加已解决的文件：

```bash
git add <冲突文件>
```

然后完成合并提交：

```bash
git commit
```

## 4.4 删除分支

当一个分支不再需要时，可以删除它来保持仓库的整洁。删除本地分支使用 `-d` 选项：

```bash
git branch -d <分支名>
```

如果分支未被合并，Git 会警告您。您可以使用 `-D` 选项强制删除分支：

```bash
git branch -D <分支名>
```

## 4.5 查看分支历史

要查看所有分支的提交历史，可以使用 `git log` 命令与 `--graph`、`--all` 选项结合：

```bash
git log --oneline --graph --all
```



